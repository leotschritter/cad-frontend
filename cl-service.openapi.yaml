---
openapi: 3.1.0
components:
  schemas:
    CommentDto:
      type: object
      properties:
        id:
          type: string
        userEmail:
          type: string
        itineraryId:
          type: integer
          format: int64
        comment:
          type: string
        createdAt:
          $ref: "#/components/schemas/LocalDateTime"
    CommentRequest:
      type: object
      properties:
        userEmail:
          type: string
        comment:
          type: string
    LikeDto:
      type: object
      properties:
        id:
          type: string
        userEmail:
          type: string
        itineraryId:
          type: integer
          format: int64
        createdAt:
          $ref: "#/components/schemas/LocalDateTime"
    LikeResponseDto:
      type: object
      properties:
        itineraryId:
          type: integer
          format: int64
        likeCount:
          type: integer
          format: int64
    LocalDateTime:
      type: string
      format: date-time
      examples:
      - 2022-03-10T12:15:50
    MessageResponseDto:
      type: object
      description: Response object for successful operations
      properties:
        message:
          type: string
          description: Success or info message
    MessageResponseDto1:
      type: object
      description: Response object for successful operations
      properties:
        message:
          type: string
          description: Success or info message
tags:
- name: Comment Management
  description: Operations for managing comments on itineraries
- name: Like Management
  description: Operations for managing likes and comments on itineraries
paths:
  /comment/itinerary/{itineraryId}:
    get:
      summary: Get comments for itinerary
      description: "Retrieves all comments for a specific itinerary, ordered by creation\
        \ date (newest first). Requires authentication."
      tags:
      - Comment Management
      parameters:
      - description: ID of the itinerary to get comments for
        example: 1
        required: true
        name: itineraryId
        in: path
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: Comments retrieved successfully
          content:
            application/json:
              examples:
                Comments response:
                  summary: Example of comments response
                  value:
                  - id: abc123
                    userEmail: john@example.com
                    itineraryId: 1
                    comment: Amazing trip! Would love to visit.
                    createdAt: 2024-06-15T10:30:00
                  - id: def456
                    userEmail: jane@example.com
                    itineraryId: 1
                    comment: Great photos!
                    createdAt: 2024-06-14T14:20:00
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CommentDto"
        "400":
          description: Bad request - Itinerary ID is required
          content:
            application/json:
              example:
                error: Itinerary ID is required
        "401":
          description: Unauthorized - Missing or invalid token
          content:
            application/json:
              example:
                error: Missing or invalid Authorization header
      security:
      - BearerAuth: []
    post:
      summary: Add comment to itinerary
      description: Adds a comment to an itinerary. Requires authentication. Users
        can add multiple comments.
      tags:
      - Comment Management
      parameters:
      - description: ID of the itinerary to comment on
        example: 1
        required: true
        name: itineraryId
        in: path
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentRequest"
        required: true
      responses:
        "200":
          description: Comment added successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CommentDto"
        "400":
          description: Bad request - Missing required fields or empty comment
          content:
            application/json:
              example:
                error: Comment text cannot be empty
        "401":
          description: Unauthorized - Missing or invalid token
          content:
            application/json:
              example:
                error: Missing or invalid Authorization header
      security:
      - BearerAuth: []
  /comment/user/{userEmail}:
    get:
      summary: Get comments by user
      description: "Retrieves all comments made by a specific user, ordered by creation\
        \ date (newest first). Requires authentication."
      tags:
      - Comment Management
      parameters:
      - description: Email of the user to get comments for
        example: john.doe@example.com
        required: true
        name: userEmail
        in: path
        schema:
          type: string
      responses:
        "200":
          description: User comments retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CommentDto"
        "400":
          description: Bad request - User email is required
          content:
            application/json:
              example:
                error: User email is required
        "401":
          description: Unauthorized - Missing or invalid token
          content:
            application/json:
              example:
                error: Missing or invalid Authorization header
      security:
      - BearerAuth: []
  /comment/{commentId}:
    delete:
      summary: Delete comment
      description: Deletes a comment. Requires authentication. Users can only delete
        their own comments.
      tags:
      - Comment Management
      parameters:
      - description: ID of the comment to delete
        example: abc123
        required: true
        name: commentId
        in: path
        schema:
          type: string
      responses:
        "200":
          description: Comment deleted successfully
          content:
            application/json:
              examples:
                Delete Success:
                  summary: Example of successful deletion
                  value:
                    message: Comment deleted successfully
              schema:
                $ref: "#/components/schemas/MessageResponseDto"
        "400":
          description: Bad request - Missing required fields or unauthorized
          content:
            application/json:
              example:
                error: You can only delete your own comments
        "401":
          description: Unauthorized - Missing or invalid token
          content:
            application/json:
              example:
                error: Missing or invalid Authorization header
        "404":
          description: Comment not found
          content:
            application/json:
              example:
                error: Comment not found
      security:
      - BearerAuth: []
  /like/itinerary/{itineraryId}:
    delete:
      summary: Remove like from itinerary
      description: Removes a like from an itinerary. Requires authentication.
      tags:
      - Like Management
      parameters:
      - description: ID of the itinerary to remove like from
        example: 1
        required: true
        name: itineraryId
        in: path
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: Like removed successfully
          content:
            application/json:
              examples:
                Like Removed:
                  summary: Example of successful like removal
                  value:
                    message: Like removed successfully
              schema:
                $ref: "#/components/schemas/MessageResponseDto1"
        "401":
          description: Unauthorized - Missing or invalid token
          content:
            application/json:
              example:
                error: Missing or invalid Authorization header
      security:
      - BearerAuth: []
    post:
      summary: Like an itinerary
      description: Adds a like to an itinerary. Requires authentication. Users can
        only like once per itinerary.
      tags:
      - Like Management
      parameters:
      - description: ID of the itinerary to like
        example: 1
        required: true
        name: itineraryId
        in: path
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: Itinerary liked successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LikeDto"
        "400":
          description: Bad request - User already liked this itinerary
          content:
            application/json:
              example:
                error: User has already liked this itinerary
        "401":
          description: Unauthorized - Missing or invalid token
          content:
            application/json:
              example:
                error: Missing or invalid Authorization header
      security:
      - BearerAuth: []
    get:
      summary: Get like count for itinerary
      description: Retrieves the number of likes for a specific itinerary. Requires
        authentication.
      tags:
      - Like Management
      parameters:
      - description: ID of the itinerary to get likes for
        example: 1
        required: true
        name: itineraryId
        in: path
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: Like count retrieved successfully
          content:
            application/json:
              examples:
                Likes response:
                  summary: Example of likes response
                  value:
                    itineraryId: 1
                    likeCount: 5
              schema:
                $ref: "#/components/schemas/LikeResponseDto"
        "400":
          description: Bad request - Itinerary ID is required
          content:
            application/json:
              example:
                error: Itinerary ID is required
        "401":
          description: Unauthorized - Missing or invalid token
          content:
            application/json:
              example:
                error: Missing or invalid Authorization header
      security:
      - BearerAuth: []
  /like/user:
    get:
      summary: Get likes by user
      description: Retrieves all likes made by the authenticated user. Requires authentication.
      tags:
      - Like Management
      responses:
        "200":
          description: User likes retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/LikeDto"
        "400":
          description: Bad request - User email is required
          content:
            application/json:
              example:
                error: User email is required
        "401":
          description: Unauthorized - Missing or invalid token
          content:
            application/json:
              example:
                error: Missing or invalid Authorization header
      security:
      - BearerAuth: []
info:
  title: comments-likes-service API
  version: 1.0.0-SNAPSHOT
